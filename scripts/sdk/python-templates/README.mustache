# CATAPA Python SDK

This Python package is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project.

## Requirements

Python 3.11+

## Installation

```bash
pip install catapa
```

## Quick Start

A complete Hello World example to get you started immediately.

```python
#!/usr/bin/env python3
"""Quick Start - Hello World Example.

A minimal, self-contained example demonstrating the basic usage of CATAPA Python SDK.
"""

from catapa import Catapa, EmployeeApi


def main() -> None:
    """Main function demonstrating basic SDK usage."""
    # Initialize the client with your credentials
    # The client automatically handles OAuth2 authentication and token refresh
    client = Catapa(
        tenant="your-tenant-id",
        client_id="your-client-id",
        client_secret="your-client-secret"
    )

    # Create an API instance
    # Tokens are automatically refreshed on every API call (5-minute buffer before expiration)
    employee_api = EmployeeApi(client)

    # Make your first API call
    # No need to worry about token expiration - it's handled automatically!
    employees = employee_api.list_all_employees(page=0, size=10)
    print(f"Found {len(employees.content)} employees")


if __name__ == "__main__":
    main()
```

## Tutorials

More Hello World and intermediate examples to help you learn the SDK.

### Tutorial 1: Using Multiple APIs

A complete example showing how to use multiple API classes with a single client.

```python
#!/usr/bin/env python3
"""Tutorial: Using Multiple APIs.

Demonstrates how to use different API classes with a single client instance.
"""

from catapa import Catapa, OrganizationApi, MasterDataApi, TaxApi


def main() -> None:
    """Main function demonstrating multiple API usage."""
    # Initialize client once
    client = Catapa(
        tenant='your-tenant',
        client_id='your-client-id',
        client_secret='your-client-secret'
    )

    # Use different APIs with the same client
    # Each API instance shares the same authentication and token management
    org_api = OrganizationApi(client)
    company = org_api.get_companies()
    print(f"Organization: {company.name}")

    master_data_api = MasterDataApi(client)
    countries = master_data_api.get_countries()
    print(f"Countries available: {len(countries.content)}")

    tax_api = TaxApi(client)
    tax_calculations = tax_api.get_tax_calculations()
    print(f"Tax calculations: {len(tax_calculations.content)}")


if __name__ == "__main__":
    main()
```

### Tutorial 2: Error Handling

A complete example demonstrating proper error handling patterns.

```python
#!/usr/bin/env python3
"""Tutorial: Error Handling.

Demonstrates how to handle errors and exceptions when using the SDK.
"""

from catapa import Catapa, EmployeeApi
from openapi_client.exceptions import ApiException


def main() -> None:
    """Main function demonstrating error handling."""
    client = Catapa(
        tenant='your-tenant',
        client_id='your-client-id',
        client_secret='your-client-secret'
    )
    employee_api = EmployeeApi(client)

    try:
        employees = employee_api.list_all_employees(page=0, size=10)
        print(f"Successfully retrieved {len(employees.content)} employees")
    except ApiException as e:
        print(f"API Error: {e.status} - {e.reason}")
        print(f"Response body: {e.body}")
    except Exception as e:
        print(f"Unexpected error: {e}")


if __name__ == "__main__":
    main()
```

## Cookbook

Intermediate to Advanced examples for real-world scenarios.

### Cookbook 1: Long-Running Services

A complete example for long-running services that need persistent API access.

```python
#!/usr/bin/env python3
"""Cookbook: Long-Running Services.

Demonstrates how the SDK handles token refresh automatically in long-running services.
Perfect for daemons, background workers, and scheduled tasks.
"""

from catapa import Catapa, EmployeeApi
import time


def main() -> None:
    """Main function for long-running service example."""
    # Initialize client once at service startup
    client = Catapa(
        tenant='your-tenant',
        client_id='your-client-id',
        client_secret='your-client-secret'
    )
    employee_api = EmployeeApi(client)

    # Make an API call
    employees = employee_api.list_all_employees(page=0, size=10)
    print(f"Initial call: {len(employees.content)} employees")

    # Simulate long-running service (e.g., wait an hour)
    # In real scenarios, this could be a loop, scheduled task, or event handler
    print("Service running... (simulating 1 hour wait)")
    time.sleep(3600)

    # This call will automatically refresh the token if needed
    # No manual token management required!
    employees = employee_api.list_all_employees(page=0, size=10)
    print(f"After 1 hour: {len(employees.content)} employees")
    print("✅ Token was automatically refreshed if needed!")


if __name__ == "__main__":
    main()
```

### Cookbook 2: Batch Processing with Pagination

A complete example for processing large datasets with pagination.

```python
#!/usr/bin/env python3
"""Cookbook: Batch Processing with Pagination.

Demonstrates how to process large datasets efficiently using pagination.
"""

from catapa import Catapa, EmployeeApi


def main() -> None:
    """Main function for batch processing example."""
    client = Catapa(
        tenant='your-tenant',
        client_id='your-client-id',
        client_secret='your-client-secret'
    )
    employee_api = EmployeeApi(client)

    # Process all employees in batches
    page = 0
    size = 100
    total_processed = 0

    while True:
        # Fetch a page of employees
        response = employee_api.list_all_employees(page=page, size=size)
        employees = response.content

        if not employees:
            break

        # Process each employee in the current page
        for employee in employees:
            # Your processing logic here
            print(f"Processing employee: {employee.name} (ID: {employee.id})")
            total_processed += 1

        # Check if there are more pages
        if len(employees) < size:
            break

        page += 1

    print(f"\n✅ Processed {total_processed} employees in total")


if __name__ == "__main__":
    main()
```

### Cookbook 3: Concurrent API Calls

A complete example for making concurrent API calls efficiently.

```python
#!/usr/bin/env python3
"""Cookbook: Concurrent API Calls.

Demonstrates how to make multiple API calls concurrently for better performance.
"""

from catapa import Catapa, EmployeeApi, OrganizationApi, MasterDataApi
from concurrent.futures import ThreadPoolExecutor, as_completed


def main() -> None:
    """Main function for concurrent API calls example."""
    client = Catapa(
        tenant='your-tenant',
        client_id='your-client-id',
        client_secret='your-client-secret'
    )

    # Create API instances
    employee_api = EmployeeApi(client)
    org_api = OrganizationApi(client)
    master_data_api = MasterDataApi(client)

    # Define API call functions
    def get_employees():
        return employee_api.list_all_employees(page=0, size=10)

    def get_organization():
        return org_api.get_companies()

    def get_countries():
        return master_data_api.get_countries()

    # Execute API calls concurrently
    with ThreadPoolExecutor(max_workers=3) as executor:
        futures = {
            executor.submit(get_employees): "employees",
            executor.submit(get_organization): "organization",
            executor.submit(get_countries): "countries"
        }

        results = {}
        for future in as_completed(futures):
            task_name = futures[future]
            try:
                results[task_name] = future.result()
                print(f"✅ {task_name} retrieved successfully")
            except Exception as e:
                print(f"❌ {task_name} failed: {e}")

    # Use the results
    if "employees" in results:
        print(f"Employees: {len(results['employees'].content)}")
    if "organization" in results:
        print(f"Organization: {results['organization'].name}")
    if "countries" in results:
        print(f"Countries: {len(results['countries'].content)}")


if __name__ == "__main__":
    main()
```

## Available APIs

All CATAPA APIs are available through the `catapa` package:

```python
from catapa import (
    Catapa,
    EmployeeApi,
    OrganizationApi,
    MasterDataApi,
    TaxApi,
    SalaryPaymentApi,
    PayrollProcessSnapshotApi,
    # ... and 40+ more APIs
)
```

{{> common_README }}
